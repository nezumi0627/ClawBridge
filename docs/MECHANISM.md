# 🧠 ClawBridge の動作メカニズム

ClawBridge がどのようにして多様な AI リソースを統合し、シームレスな体験を提供しているのかを解説します。

---

## 1. インテリジェント・ルーティング
ClawBridge は単一の受信窓口として動作し、リクエストされた内容（モデル名、ツール使用の有無）に応じて、最適なプロバイダを自動選択します。

| プロバイダ | 特徴 | 主な用途 |
| :--- | :--- | :--- |
| **Pollinations** | 認証不要・超高速 | 標準的な雑談、画像生成 |
| **G4F (GPT4Free)** | 多様な無料リソース | 高度な推論、最新モデルの試用 |
| **Official APIs** | 最高レベルの安定性 | Gemini, Groq などの高速アクセス |

## 2. Tool Polyfill (ツール補完機能)
多くの無料 AI プロバイダは、OpenAI 形式のネイティブな「ツール呼び出し（Tool Call）」に対応していません。ClawBridge は **ToolService** を介して、以下の処理を自動で行います。

1.  **プロンプト変換**: 利用可能なツール情報をシステムプロンプトとして高精度な JSON 命令に変換し、モデルへ注入。
2.  **出力解析**: モデルが返した JSON 命令をリアルタイムで検知し、OpenAI 互換のツールコールパケットとして再構成して OpenClaw へ返却。
3.  **結果のリダイレクト**: ツールの実行結果を再びモデルへ渡す際、モデルが理解しやすい文脈に自動整形。

## 3. レスポンス・クレンジング
無料モデルは時として、メタデータや不要な思考プロセス（Reasoning タグなど）を含めて回答してくることがあります。ClawBridge はこれらを検知し、純粋なユーザーへの回答のみを抽出して整形します。

## 4. プロキシ＆フォールバック
特定のプロバイダでエラーやレート制限が発生した場合、ClawBridge は瞬時に代替プロバイダ（フォールバック）を試行します。これにより、ユーザーは接続断を意識することなく対話を継続できます。

---

[⬅️ ドキュメントセンターに戻る](./README.md)
